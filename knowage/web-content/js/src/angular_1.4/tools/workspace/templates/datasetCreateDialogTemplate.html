<md-dialog flex class="mdDialogDatasetWizard" ng-cloak>
  
	<md-toolbar>
      
		<div class="md-toolbar-tools">
      
			<h2>{{translate.load('sbi.workspace.dataset.wizard')}}</h2>
	   
			<span flex></span> 
	         
			<md-button 	class="" ng-click="toggleDWVBack()" ng-if="datasetWizardView>1" 
						title="{{translate.load('sbi.workspace.dataset.wizard.backbutton.tooltip')}}"> 
				<md-icon class="fa fa-arrow-circle-o-left fa-2x">
			</md-button>
			
			<md-button 	class="" ng-click="toggleDWVNext()" 
						ng-disabled="nextOrSaveButtonCondition()"
						title="{{datasetWizStep1NextButtonTitle()}}"> 
				 <md-icon ng-show="datasetWizardView==4" class="fa fa-floppy-o fa-2x"></md-icon> 
				 <md-icon ng-show="datasetWizardView!=4" class="fa fa-arrow-circle-o-right fa-2x"></md-icon> 		
				
			</md-button>
			
			<md-button 	class="" ng-click="closeDatasetCreateDialog()" 
						title="{{translate.load('sbi.workspace.dataset.wizard.closebutton.tooltip')}}">
				 <md-icon class="fa fa-times-circle-o fa-2x"></md-icon> 
			</md-button>
            
		</div>
      
	</md-toolbar>
   
	<md-content flex class="knowageGrey">
      
		<!-- CARD 1 (START) -->
		<!--<md-card ng-if="datasetWizardView==1">-->
        <div ng-if="datasetWizardView==1">
        
			<md-whiteframe flex layout="column" layout-margin class="md-whiteframe-5dp">
				
				<md-toolbar class="secondaryToolbar">
		         	<div class="md-toolbar-tools">
		           		<h2>{{translate.load('sbi.workspace.dataset.wizard.load')}}</h2>
		               	<span flex></span>
		            </div>
				</md-toolbar>
		         
				<md-content class="loadFilePadding">
		         	
					<form>
			               
						<div layout="row" layout-wrap>
			                 
			                  <div flex>
			                     
			                     <md-input-container class="small counter">
			                     
			                        <label>{{translate.load('sbi.workspace.dataset.wizard.category')}}</label> 
			                        <md-select aria-label="aria-label" ng-model="dataset.catTypeVn">
			                           <md-option 	ng-repeat="category in datasetCategoryType" 
			                           				ng-click="chooseCategory(category)"
			                           				value="{{category.VALUE_NM}}">
	                           				{{category.VALUE_NM}}
                           				</md-option>
			                        </md-select>
			                        
			                     </md-input-container>
			                     
			                  </div>
			                  
						</div>
			               
						<div flex=50 layout="row">
			                  <label class="checkboxPadding">{{translate.load('sbi.workspace.dataset.wizard.limit')}}</label> 
			                  <md-input-container class="small counter">
			                     <md-checkbox 	aria-label="Checkbox 1" 
			                     				ng-model="limitPreviewChecked" ng-checked="toggleLimitPreview()">
           						</md-checkbox>
			                  </md-input-container>
						</div>
			               
						<div layout="row" layout-wrap ng-show="dataset.fileName=='' || changingFile">
		                  	
		                  	<label layout-align="center center" class="buttonLabel">
		                  		{{translate.load("sbi.ds.wizard.selectFile")}}:
	                  		</label>
		                  	
		                  	<file-upload 	flex ng-model="fileObj" id="datasetFile" 
		                  					ng-click="fileChange();checkChange();fileObjTakeBackup()" 
			                  				title="{{translate.load('sbi.workspace.dataset.wizard.browsefile.tooltip')}}">
                			</file-upload>
		                  	
		                  	<div class="uploadButton">
			                    <md-button 	ng-click="uploadFile()" class="md-raised" 
			                     			ng-disabled="!fileObj.fileName || (changingFile && dataset.fileName==fileObj.fileName)" 
			                     			title="{{datasetWizStep1UploadButtonTitle()}}">
	                     			{{translate.load("sbi.workspace.dataset.wizard.upload")}}
             					</md-button>
		                  	</div>
						</div>
						
						<div layout="row" layout-wrap ng-if="dataset.fileName!='' && !changingFile">
					 		
					 		<label layout-align="center center" class="buttonLabel">
					 			Uploaded file: <strong>{{dataset.fileName}}</strong>
				 			</label>
				 			
						 <span flex></span>
						  
						  	<div class="uploadButton">
						    <md-button 	ng-click="changeUploadedFile()" ng-show="!ckanInWizard" class="md-raised" 
						    			title="{{translate.load('sbi.workspace.dataset.wizard.file.change.tooltip')}}">
	                     			{{translate.load("sbi.workspace.dataset.wizard.file.change")}}
             				</md-button>
           					</div>
             				
						</div>
			               
					</form>
		            
		       	</md-content>
		       	
	       	</md-whiteframe>
	       	
         
         	<!-- <md-whiteframe flex layout="column" layout-margin class="md-whiteframe-5dp md-whiteframe-5dp-rightPanelDocuments"> -->
         		
       		<md-whiteframe flex layout="column" layout-margin class="md-whiteframe-5dp threeCombosThreeNumFields">         		
         		
         		<div layout="row">								
			              
			        <!-- CSV file is uploaded --> 
					<div layout="row" flex ng-if="dataset.fileType=='CSV'">
		                 	
	                 	<div layout="row" layout-wrap flex=33>
	                  		<div flex=90 layout-align="center center">
	                     		<md-input-container class="small counter">
	                        		<label>{{translate.load("sbi.ds.file.csv.delimiter")}}</label> 
	                        		<md-select aria-label="aria-label" ng-model="dataset.csvDelimiter">
	                           			<md-option 	ng-repeat="csvDelimiterCharacterItem in csvDelimiterCharacterTypes" 
	                           						ng-click="chooseDelimiterCharacter(csvDelimiterCharacterItem)" 
	                           						value="{{csvDelimiterCharacterItem.name}}">
                          						{{csvDelimiterCharacterItem.name}}
                     						</md-option>
	                        		</md-select>
		                     	</md-input-container>
		                  	</div>
						</div>
	                 	
                		<div layout="row" layout-wrap flex=33>
	                  		<div flex=90 layout-align="center center">
	                     		<md-input-container class="small counter">
	                        		<label>{{translate.load("sbi.ds.file.csv.quote")}}</label> 
	                        		<md-select aria-label="aria-label" ng-model="dataset.csvQuote">
	                           			<md-option 	ng-repeat="csvQuoteCharacterItem in csvQuoteCharacterTypes" 
	                           						ng-click="chooseQuoteCharacter(csvQuoteCharacterItem)" 
	                           						value="{{csvQuoteCharacterItem.name}}">
                          						{{csvQuoteCharacterItem.name}}
                     						</md-option>
	                        		</md-select>
		                     	</md-input-container>
		                  	</div>
						</div>
						
						<div layout="row" layout-wrap flex=33>
	                  		<div flex=90 layout-align="center center">
	                     		<md-input-container class="small counter">
	                        		<label>{{translate.load("sbi.workspace.dataset.wizard.csv.encoding")}}</label> 
	                        		<md-select aria-label="aria-label" ng-model="dataset.csvEncoding">
	                           			<md-option 	ng-repeat="csvEncodingItem in csvEncodingTypes" 
	                           						ng-click="chooseEncoding(csvEncodingItem)" 
	                           						value="{{csvEncodingItem.name}}">
                          						{{csvEncodingItem.name}}
                     						</md-option>
	                        		</md-select>
		                     	</md-input-container>
		                  	</div>
						</div>
							
					</div>
					
					<!-- XLS file is uploaded -->
					<div layout="row" flex ng-if="dataset.fileType=='XLS'">
						
						<div layout="row" layout-wrap flex=33>
	                  		<div flex=90 layout-align="center center">
	                     		<md-input-container class="small counter">
	                        		<label>{{translate.load("sbi.ds.file.xsl.skiprows")}}</label> 
	                        		<input 	ng-model="dataset.skipRows" type="number" 
	                        				step="1" min="0" value="{{dataset.skipRows}}">
		                     	</md-input-container>
		                  	</div>
						</div>
	                 	
                		<div layout="row" layout-wrap flex=33>
	                  		<div flex=90 layout-align="center center">
	                     		<md-input-container class="small counter">
	                        		<label>{{translate.load("sbi.ds.file.xsl.limitrows")}}</label> 
	                        		<input 	ng-model="dataset.limitRows" type="number" 
	                        				step="1" min="0" value="{{dataset.limitRows}}">
		                     	</md-input-container>
		                  	</div>
						</div>
						
						<div layout="row" layout-wrap flex=33>
	                  		<div flex=90 layout-align="center center">
	                     		<md-input-container class="small counter">
	                        		<label>{{translate.load("sbi.ds.file.xsl.sheetnumber")}}</label> 
	                        		<input 	ng-model="dataset.xslSheetNumber" type="number" 
	                        				step="1" min="1" value="{{dataset.xslSheetNumber}}">
		                     	</md-input-container>
		                  	</div>
						</div>
						
					</div>
						
				</div>					
				
       	 	</md-whiteframe>
       	 	
         </div>
		
		<!-- </md-card>CARD 1 (END) -->
      
		<!-- CARD 2 (START) -->
      	<md-card ng-if="datasetWizardView==2">
         
         	<md-toolbar class="secondaryToolbar">
            	<div class="md-toolbar-tools">
               	<h2>{{translate.load('sbi.workspace.dataset.wizard.load')}} &#10137; {{translate.load('sbi.ds.wizard.metadata')}}</h2>
               	<span flex></span>
           	 	</div>
         	</md-toolbar>
         
         	<md-content flex class="loadFilePadding step2DefDataCardContent">
	            <form>
	               <dataset-wizard-meta></dataset-wizard-meta>
	            </form>
         	</md-content>
         
		</md-card>
      	<!-- CARD 2 (END) -->
     
      	<!-- CARD 3 (START) -->
      	<md-card ng-if="datasetWizardView==3">
      	
         	<md-toolbar class="secondaryToolbar">
	            <div class="md-toolbar-tools">
	               <h2>{{translate.load('sbi.workspace.dataset.wizard.load')}} &#10137; {{translate.load('sbi.ds.wizard.metadata')}} &#10137; {{translate.load('sbi.ds.wizard.validation')}}</h2>
	               <span flex></span>
	            </div>
         	</md-toolbar>
         
         	<md-content flex class="loadFilePadding step3PreviewPanel">
	            
	            <form>
	               
	               <!-- VALIDATION DATA -->
	               	               
				    <md-content flex>
						
						<!-- 			    
				    	<md-toolbar class="documentBrowserToolbar secondaryToolbar">
							
							<div class="md-toolbar-tools" layout="row" layout-align="center center">
						   		
						   		<md-button class="md-fab md-mini" aria-label="backPagination" ng-click="getBackPreviewSet()">
				          			<md-icon class="fa fa-angle-double-left"></md-icon>				        		
				        		</md-button>
				        		
				        		<span flex></span>
				        		
				        		<div>{{startPreviewIndex+1 +'&nbsp-&nbsp'+ endPreviewIndex + '&nbsp/&nbsp'+totalItemsInPreview}} </div>
				        		
				        		<span flex></span>
				             	
				             	<md-button class="md-fab md-mini" aria-label="forwardPagination" ng-click="getNextPreviewSet()">
				          			<md-icon class="fa fa-angle-double-right"></md-icon>
				        		</md-button>
				        		
				    		</div>
				    		
				    	</md-toolbar>				    	 	
				    
				    	<br> 
				    	-->
				
				 		<md-content flex class="step3PreviewTable">
				 		
							<angular-table 
							            flex
							            style="position:absolute;"
							            ng-model="resultRowsStep2"
										columns="allHeadersForStep3Preview" 
										no-pagination=true
										show-search-bar=false>
							</angular-table>
						
				 		</md-content>
				 		
					</md-content>	
					               
	            </form>
	            
         	</md-content>      	
         	
      	</md-card>
     	<!-- CARD 3 (END) -->
     	
     	<!-- Validation status text: the validation state after going from the Step 2 to the Step 3 -->
      	<p 	ng-show="validationStatus && datasetWizardView==3" 
      		class="step3ValidationText {{validationStatus ? 'validStatusColor' : 'invalidStatusColor'}}">
      		{{validationStatus ? translate.load("sbi.ds.metadata.msgOK") : translate.load("sbi.ds.metadata.msgKO")}}
   		</p>
      	
      	<!-- CARD 4 (START) -->
      	<div ng-if="datasetWizardView==4">
        
			<md-whiteframe flex layout="column" layout-margin class="md-whiteframe-5dp">
				
				<md-toolbar class="secondaryToolbar">
		         	<div class="md-toolbar-tools">
		           		<h2>{{translate.load('sbi.workspace.dataset.wizard.load')}}</h2>
		               	<span flex></span>
		            </div>
				</md-toolbar>
		         
				<md-content class="loadFilePadding">
		         	
					<form name="formForSaving">
			               
						<div layout="row" layout-wrap>
			                  <div flex>
			                     <md-input-container class="md-block">
			                        <label>{{translate.load("sbi.generic.name")}}</label> 			                        
			                        <input type="text" ng-model="dataset.name">
		                         	<div  ng-messages="formForSaving.lbl.$error" ng-show="dataset.name==''">
				                        <div ng-messages="required">{{translate.load("sbi.workspace.required")}}</div>
						          	</div>
			                     </md-input-container>
			                  </div>
						</div>
						
						<div layout="row" layout-wrap>
			                  <div flex>
			                     <md-input-container class="small counter">
			                        <label>{{translate.load("sbi.generic.descr")}}</label> 
			                        <textarea rows="2" cols="50" ng-model="dataset.description" style="overflow:auto;auto-scroll:true"></textarea>
			                     </md-input-container>
			                  </div>
						</div>
						
			           	<div flex=50 layout="row">
	                  		<label class="checkboxPadding">{{translate.load("sbi.ds.isPersisted")}}</label> 
	                  		<md-input-container class="small counter step4BottomPadding">
	                     		<md-checkbox 	aria-label="Checkbox 2" 
		                     					ng-model="dataset.persist" ng-checked="">
								</md-checkbox>
	                  		</md-input-container>
						</div>
						
						<div layout="row">
							<label ng-show="dataset.persist" class="step4BottomPadding">
								{{translate.load('sbi.workspace.dataset.wizard.tableprefix.label')}} <strong>{{dataset.tablePrefix}}</strong>
							</label>
						</div>
						
						<div layout="row" layout-wrap>
			                  <div flex>
			                     <md-input-container class="small counter" ng-show="dataset.persist">
			                        <label>{{translate.load("sbi.ds.persistTableName")}}</label> 
			                        <input ng-model="dataset.tableName">
			                        <div  ng-messages="formForSaving.lbl.$error" ng-show="dataset.persist && dataset.tableName==''">
				                        <div ng-messages="required">{{translate.load("sbi.workspace.required")}}</div>
						          	</div>
			                     </md-input-container>
			                  </div>
						</div>
						
					</form>					
		            
		       	</md-content>
		       	
	       	</md-whiteframe>
         
         </div>
      	<!-- CARD 4 (END) -->
      
   </md-content>
   
</md-dialog>