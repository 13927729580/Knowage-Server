<div layout="column" class="qbeCustomTable" flex>
	<div style="padding-bottom:5px">
		<md-toolbar>
	   		<div class="md-toolbar-tools secondaryToolbar">
	   			
	   			<ng-transclude></ng-transclude>
	   			
	   			<span flex></span>
	   			<i ng-if="ngModel.length > 0" class="md-icon-button" ng-click="removeColumns(ngModel)">
	   				<md-tooltip md-delay="500">{{::translate.load("kn.qbe.selectgridpanel.buttons.tt.deleteall")}}</md-tooltip>
	   				<span class="fa-stack">
					  <i class="fas fa-ban fa-stack-2x"></i>
					  <i class="fas fa-columns fa-stack-1x"></i>
					</span>
	   			</i>
	   			<i class="md-icon-button" ng-if="filters.length>0" ng-click="deleteAllFilters()">
	   				<md-tooltip md-delay="500">{{::translate.load("kn.qbe.filtergridpanel.buttons.tt.delete")}}</md-tooltip>
	   				<span class="fa-stack">
					  <i class="fas fa-ban fa-stack-2x"></i>
					  <i class="fas fa-filter fa-stack-1x"></i>
					</span>
	   			</i>

				<md-button class="md-icon-button" ng-click="showHiddenColumns()" ng-if="hiddenColumns()">
					<md-tooltip md-delay="500"> {{::translate.load("kn.qbe.custom.table.show.hidden.columns.tooltip")}}</md-tooltip>
					<md-icon md-font-icon="fa fa-eye"></md-icon>
				</md-button>
	   			<md-switch ng-model="query_service.smartView" aria-label="Switch smart preview">
				    {{::translate.load("kn.qbe.custom.table.smartdata")}}
				</md-switch>
				 
				<md-button ng-if="selectedVisualization=='previewData' && !query_service.smartView" class="md-icon-button"  ng-click="executeRequest()">
					<md-icon md-font-icon="fa fa-play">
						<md-tooltip md-delay="500">{{::translate.load('kn.qbe.execute')}}</md-tooltip>
					</md-icon>
				</md-button>
				
				<md-menu>
					<md-button class="kn-list-action-button md-icon-button" ng-click="openMenu($mdOpenMenu,$event)">
						<md-tooltip> {{::translate.load("kn.qbe.export.menu.tooltip")}}</md-tooltip>
						<md-icon md-menu-origin md-font-icon="fa fa-ellipsis-v"></md-icon>
						</md-button>
						<md-menu-content width="4" class="qbeMenuContent">
							<md-menu-item>
								<md-button ng-click="showSQLQuery()">{{::translate.load('kn.generic.query.SQL')}}</md-button>
							</md-menu-item>
							<md-menu-item ng-show="ngModel.length>0">
								<md-checkbox ng-model="distinct" class="menuCheckbox" style="width:auto"></md-checkbox>
								<span>{{::translate.load("kn.qbe.custom.table.distinct")}}</span>
							</md-menu-item>
							<md-menu-item>
								<md-button ng-click="openDialogForParams(ngModel)">{{::translate.load('kn.qbe.calculatedFields.parameters')}}</md-button>
							</md-menu-item>
							<md-menu-item ng-if="!query_service.smartView">
								<md-button ng-click="showCalculatedField(ngModel)">{{::translate.load('kn.qbe.calculatedFields')}}</md-button>
							</md-menu-item>
							<md-menu-item>
								<md-button ng-click="openFiltersAdvanced()">{{::translate.load('kn.qbe.filter.advanced')}}</md-button>
							</md-menu-item>
							<md-menu-item>
								<md-button ng-click="openDialogJoinDefinitions(ngModel)">{{::translate.load("kn.qbe.custom.table.toolbar.join.definition")}}</md-button>
							</md-menu-item>
							<md-menu-item ng-if="ngModel.length>0">
								<export-menu  ></export-menu>
							</md-menu-item>
						</md-menu-content>		
				</md-menu>
	   		</div>
	   	</md-toolbar>
   	</div>
   	<md-whiteframe flex>
   		<md-content >
   			<qbe-advanced-visualization ng-if="selectedVisualization=='advanced'" ng-model="filters"></qbe-advanced-visualization>
   			<qbe-filter-visualization ng-if="selectedVisualization=='filters'"></qbe-filter-visualization>
   	
   			<div layout="column" ng-if="selectedVisualization=='previewData' && !query_service.smartView">
   				<md-card layout-padding layout="column">	
					<angular-table
						id="basicView"
						layout-fill
						ng-model="ngModel"
						columns='basicViewColumns'
						scope-functions=basicViewScopeFunctions
						speed-menu-option="treeSpeedMenu"
						no-pagination=true
						allow-edit=true>
					</angular-table>									
				</md-card>
			</div>

	<div layout="row" ng-if="selectedVisualization=='previewData' && query_service.smartView">
		
		<div
			ag-grid="qbeTableGrid"
			class="ag-theme-balham ag-theme-knowage-advanced ag-noBorders"
			style="width: 100%"
			ng-show="ngModel && ngModel.length > 0">
		</div>
		
	</div>
  </md-content>
  <div layout="row" ng-if="query_service.smartView && ngModel.length > 0 && results > 0">
     <div class="ag-theme-balham" flex>
			<div class=" ag-paging-panel ag-noBorders ag-font-style">
		   		<span ref="eSummaryPanel" class="ag-paging-row-summary-panel">
		       		<span ref="lbFirstRowOnPage">{{(start * itemsPerPage) + 1}}</span> to <span ref="lbLastRowOnPage">{{maxPageNumber()}}</span> of <span ref="lbRecordCount">{{results}}</span>
		   		</span>
		   		<span class="ag-paging-page-summary-panel">
		   			<div ref="btFirst" class="ag-paging-button" ng-class="{'ag-disabled':disableFirst()}"><span class="ag-icon ag-icon-first" unselectable="on"></span>
		       			<button type="button" ref="btFirst" ng-disabled="disableFirst()" ng-click="first()">First</button>
		      			</div>
		      			<div ref="btPrevious" class="ag-paging-button" ng-class="{'ag-disabled':disableFirst()}"><span class="ag-icon ag-icon-previous" unselectable="on"></span>
		       			<button type="button" ref="btPrevious" ng-disabled="disableFirst()" ng-click="prev()">Previous</button>
		       		</div>
		       		Page <span ref="lbCurrent">{{start + 1}}</span> of <span ref="lbTotal">{{totalPages}}</span>
		       		<div ref="btNext" class="ag-paging-button" ng-class="{'ag-disabled':disableLast()}"><span class="ag-icon ag-icon-next" unselectable="on"></span>
		       			<button type="button" ref="btNext" ng-click="next()" ng-disabled="disableLast()">Next</button>
		       		</div>
		       		<div ref="btLast" class="ag-paging-button" ng-class="{'ag-disabled':disableLast()}"><span class="ag-icon ag-icon-last" unselectable="on"></span>
		       			<button type="button" ref="btLast" ng-disabled="disableLast()" ng-click="last()">Last</button>
		       		</div>
		   		</span>
			</div>
		</div>
	</div>
  </md-whiteframe>
  	
	<!--  md-whiteframe ng-if="query_service.smartView && ngModel.length > 0 && results > 0" class="md-whiteframe-3dp" layout="row">
		<span flex></span>
	 	<qbe-pagination total-count="results" on-page-change='pageChanged(newPageNumber)'></qbe-pagination>
	 	<div flex="5"></div>
	</md-whiteframe-->

</div>